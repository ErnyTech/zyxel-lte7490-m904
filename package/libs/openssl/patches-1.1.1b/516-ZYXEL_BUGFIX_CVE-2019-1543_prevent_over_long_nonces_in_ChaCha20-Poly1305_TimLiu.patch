Index: openssl-1.1.1b/crypto/evp/e_chacha20_poly1305.c
===================================================================
--- openssl-1.1.1b.orig/crypto/evp/e_chacha20_poly1305.c	2019-02-26 22:15:30.000000000 +0800
+++ openssl-1.1.1b/crypto/evp/e_chacha20_poly1305.c	2021-01-06 18:38:56.385344348 +0800
@@ -30,6 +30,8 @@
 
 #define data(ctx)   ((EVP_CHACHA_KEY *)(ctx)->cipher_data)
 
+#define CHACHA20_POLY1305_MAX_IVLEN     12
+
 static int chacha_init_key(EVP_CIPHER_CTX *ctx,
                            const unsigned char user_key[CHACHA_KEY_SIZE],
                            const unsigned char iv[CHACHA_CTR_SIZE], int enc)
@@ -533,7 +535,7 @@
         return 1;
 
     case EVP_CTRL_AEAD_SET_IVLEN:
-        if (arg <= 0 || arg > CHACHA_CTR_SIZE)
+        if (arg <= 0 || arg > CHACHA20_POLY1305_MAX_IVLEN)
             return 0;
         actx->nonce_len = arg;
         return 1;
