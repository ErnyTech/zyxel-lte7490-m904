Index: curl-7.65.3/lib/security.c
===================================================================
--- curl-7.65.3.orig/lib/security.c	2019-07-16 18:24:31.000000000 +0800
+++ curl-7.65.3/lib/security.c	2021-01-07 16:21:58.919261207 +0800
@@ -191,7 +191,6 @@
                           struct krb5buffer *buf)
 {
   int len;
-  void *tmp = NULL;
   CURLcode result;
 
   result = socket_read(fd, &len, sizeof(len));
@@ -201,12 +200,11 @@
   if(len) {
     /* only realloc if there was a length */
     len = ntohl(len);
-    tmp = Curl_saferealloc(buf->data, len);
+    buf->data = Curl_saferealloc(buf->data, len);
   }
-  if(tmp == NULL)
+  if(!len || !buf->data)
     return CURLE_OUT_OF_MEMORY;
 
-  buf->data = tmp;
   result = socket_read(fd, buf->data, len);
   if(result)
     return result;
