Index: linux-3.10.14/include/uapi/linux/snmp.h
===================================================================
--- linux-3.10.14.orig/include/uapi/linux/snmp.h	2016-01-08 14:07:01.000000000 +0800
+++ linux-3.10.14/include/uapi/linux/snmp.h	2019-06-28 15:32:58.011439583 +0800
@@ -253,6 +253,7 @@
 	LINUX_MIB_TCPFASTOPENLISTENOVERFLOW,	/* TCPFastOpenListenOverflow */
 	LINUX_MIB_TCPFASTOPENCOOKIEREQD,	/* TCPFastOpenCookieReqd */
 	LINUX_MIB_TCPSPURIOUS_RTX_HOSTQUEUES, /* TCPSpuriousRtxHostQueues */
+	//LINUX_MIB_TCPWQUEUETOOBIG,		/* TCPWqueueTooBig */
 	__LINUX_MIB_MAX
 };
 
Index: linux-3.10.14/net/ipv4/proc.c
===================================================================
--- linux-3.10.14.orig/net/ipv4/proc.c	2016-01-08 14:07:06.000000000 +0800
+++ linux-3.10.14/net/ipv4/proc.c	2019-06-28 15:34:11.903439583 +0800
@@ -273,6 +273,7 @@
 	SNMP_MIB_ITEM("TCPFastOpenListenOverflow", LINUX_MIB_TCPFASTOPENLISTENOVERFLOW),
 	SNMP_MIB_ITEM("TCPFastOpenCookieReqd", LINUX_MIB_TCPFASTOPENCOOKIEREQD),
 	SNMP_MIB_ITEM("TCPSpuriousRtxHostQueues", LINUX_MIB_TCPSPURIOUS_RTX_HOSTQUEUES),
+	//SNMP_MIB_ITEM("TCPWqueueTooBig", LINUX_MIB_TCPWQUEUETOOBIG),
 	SNMP_MIB_SENTINEL
 };
 
Index: linux-3.10.14/net/ipv4/tcp_output.c
===================================================================
--- linux-3.10.14.orig/net/ipv4/tcp_output.c	2019-06-28 13:49:12.059439583 +0800
+++ linux-3.10.14/net/ipv4/tcp_output.c	2019-06-28 15:38:51.411439583 +0800
@@ -1058,6 +1058,11 @@
 	if (nsize < 0)
 		nsize = 0;
 
+	//if (unlikely((sk->sk_wmem_queued >> 1) > sk->sk_sndbuf)) { //Tocheck: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/ipv4/tcp_output.c
+	//	NET_INC_STATS(sock_net(sk), LINUX_MIB_TCPWQUEUETOOBIG);
+	//	return -ENOMEM;
+	//}
+
 	if (skb_cloned(skb) &&
 	    skb_is_nonlinear(skb) &&
 	    pskb_expand_head(skb, 0, 0, GFP_ATOMIC))
